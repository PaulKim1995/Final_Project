{
    "contents" : "# ============================================================================== \n# Analysis Script for the Final Project\n# Author(s): Jeff Grant and Paul Kim\n# Date: 08-11-2015 \n# Description: This code takes the previous csv files and uses them for analysis\n# Data: \"storms.csv\" & \"tracks.csv\"\n# ==============================================================================\n\n\n#loading libraries and reading in the data\nlibrary(readr)\nlibrary(stringr)\nlibrary(ggplot2)\nlibrary(dplyr)\n\nstorms = read_csv(\"./data/storms.csv\")\ntracks = read_csv(\"./data/tracks.csv\")\n\n#Totaling the number of storms per year and plotting\ntracks$year = as.numeric(str_extract(tracks$tracks_date, \"[0-9]{4}\"))\n\nmodern = tracks[32665:45735,]\n\nyear_total = aggregate(modern$tracks_wind, \n                     list(modern$tracks_id, modern$year), sum )\ntapply(year_total$x, year_total$Group.2, length)\n\nbarplot(tapply(year_total$x, year_total$Group.2, length), \n        xlab = \"Year\", \n        ylab = \"Number of Storms\", \n        main = \"Annual Frequency of Storms\")\n#getting the number of storms that are above 35 in each year and plotting\ngroup = aggregate(modern$tracks_wind>=35, \n                list(modern$tracks_id, modern$year), sum)\n\ngroup = group[group$x!=0,]\n\ntapply( group$x, group$Group.2, length)\n\nbarplot(tapply( group$x, group$Group.2, length), \n        xlab = \"Year\", \n        ylab = \"Number of Tropical Storms\", \n        main = \"Annual Frequency of Tropical Storms\")\n\n#getting the number of storms that are above 64 in each year and plotting\ngroup1 = aggregate(modern$tracks_wind>=64, \n                 list(modern$tracks_id, modern$year), sum )\n\ngroup1 = group1[group1$x!=0,]\n\ntapply(group1$x, group1$Group.2, length)                 \n\nbarplot(tapply( group1$x, group1$Group.2, length), \n        xlab = \"Year\", \n        ylab = \"Number of Hurricanes\",\n        main = \"Annual Frquency of Hurricanes\")\n\n#getting the number of storms that are above 96 in each year and plotting\ngroup2 = aggregate(modern$tracks_wind>=96, \n                 list(modern$tracks_id, modern$year), sum )\n\ngroup2 = group2[group2$x!=0,]\n\ntapply(group2$x, group2$Group.2, length)\n\nbarplot(tapply( group2$x, group2$Group.2, length), \n        xlab = \"Year\", \n        ylab = \"Number of Stage 3 and Above Hurricanes\",\n        main = \"Annual Frequency of Stage 3 Hurricanes\")\n\n#getting the number of storms in each month and plotting\nmodern$month = as.numeric(str_extract(modern$tracks_date, \"[0-9]{2}\"))\n\nmonth = aggregate(modern$tracks_wind, \n                list(modern$tracks_id, modern$month), sum )\n\ntapply(month$x, month$Group.2, length)\n\nbarplot(tapply( month$x, month$Group.2, length), \n        xlab = \"Month\", \n        ylab = \"Number of Storms\",\n        main = \"Monthly Frequency of Storms\")\n\n#getting the number of storms that are above 35 in each month and plotting\ngroup3 = aggregate(modern$tracks_wind>=35\n                 ,list(modern$tracks_id, modern$month), sum )\n\ngroup3 = group3[group3$x!=0,]\n\ntapply( group3$x, group3$Group.2, length)\n\nbarplot(tapply( group3$x, group3$Group.2, length), \n        xlab = \"Month\", \n        ylab = \"Number of Tropical Storms\",\n        main = \"Monthly Frequency of Tropical Storms\")\n\n#getting the number of storms that are above 64 in each month and plotting\ngroup4 = aggregate(modern$tracks_wind>=64, \n                 list(modern$tracks_id, modern$month), sum )\n\ngroup4 = group4[group4$x!=0,]\n\ntapply( group4$x, group4$Group.2, length)\n\nbarplot(tapply( group4$x, group4$Group.2, length), \n        xlab = \"Month\", \n        ylab = \"Number of Hurricanes\",\n        main = \"Monthly Frequency of Hurricanes\")\n\n#getting the number of storms that are above 96 in each month and plotting\ngroup5 = aggregate(modern$tracks_wind>=96, \n                 list(modern$tracks_id, modern$month), sum )\n\ngroup5 = group5[group5$x!=0,]\n\ntapply( group5$x, group5$Group.2, length)\n\nbarplot(tapply( group5$x, group5$Group.2, length), \n        xlab = \"Month\", \n        ylab = \"Number of Stage 3 and Above Hurricanes\",\n        main = \"Monthly Frequency of Stage 3 and Above Hurricanes\")\n\n#Creating the summary statistics for the 3 storm types\n\n#Summary statistics for Tropical Storms\ntrop_storm = (tapply( group$x, group$Group.2, length))\n\n#average value for hurricanes\nmean(trop_storm)\nmean_trop = as.numeric(strtrim(as.character(mean(trop_storm)), width = 4))\n\n#standard deviation for hurricanes\nsd(trop_storm)\nsd_trop = round(sd(trop_storm), 2)\n\n#median for hurricanes\nmedian(trop_storm)\nmedian_trop = median(trop_storm)\n\n#1st quartile for hurricanes\nas.numeric(summary(trop_storm)[2])\nonequart_trop = as.numeric(summary(trop_storm)[2])\n\n#3rd quartile for hurricanes\nas.numeric(summary(trop_storm)[5])\nthreequart_trop = as.numeric(summary(trop_storm)[5])\n\n\n#Summary statistics for Hurricanes\ntrop_hurr = (tapply( group1$x, group1$Group.2, length))\n\n#average value for hurricanes\nmean(trop_hurr)\nmean_hurr = round(mean(trop_hurr), 1)\n\n#standard deviation for hurricanes\nsd(trop_hurr)\nsd_hurr = as.numeric(strtrim(as.character(sd(trop_hurr)), width = 4))\n\n#median for hurricanes\nmedian(trop_hurr)\nmedian_hurr= median(trop_hurr)\n\n#1st quartile for hurricanes\nas.numeric(summary(trop_hurr)[2])\nonequart_hurr=as.numeric(summary(trop_hurr)[2])\n\n#3rd quartile for hurricanes\nas.numeric(summary(trop_hurr)[5])\nthreequart_hurr=as.numeric(summary(trop_hurr)[5])\n\n#Summary statistics for Hurricanes (stage 3)\ntrop_hurr3 = (tapply( group2$x, group2$Group.2, length))\n\n#average value for hurricanes\nmean(trop_hurr3)\nmean_hurr3 = as.numeric(strtrim(as.character(mean(trop_hurr3)), width = 3))\n\n#standard deviation for hurricanes\nsd(trop_hurr3)\nsd_hurr3 = as.numeric(strtrim(as.character(sd(trop_hurr3)), width = 4))\n\n#median for hurricanes\nmedian(trop_hurr3)\nmedian_hurr3=median(trop_hurr3)\n\n#1st quartile for hurricanes\nas.numeric(summary(trop_hurr3)[2])\nonequart_hurr3=as.numeric(summary(trop_hurr3)[2])\n\n#3rd quartile for hurricanes\nas.numeric(summary(trop_hurr3)[5])\nthreequart_hurr3 = as.numeric(summary(trop_hurr3)[5])\n\n#Table of summary statistics\nstorms_summary = data.frame(\n  \"Avg\" = c(mean_trop, \n            mean_hurr, \n            mean_hurr3),\n  \"Std Dev\" = c(sd_trop, \n                sd_hurr, \n                sd_hurr3),\n  \"First Quartile\" = c(onequart_trop, \n                       onequart_hurr,\n                       onequart_hurr3),\n  \"Median\"= c(median_trop, \n              median_hurr, \n              median_hurr3),\n  \"Third Quartile\" = c(threequart_trop,\n                       threequart_hurr,\n                       threequart_hurr3),\n          row.names = c(\"35 Knots\", \"64 Knots\", \"96 Knots\")\n)\n\nstorms_summary\n\n#Creating png files for each of the plots\npng(\"./images/storms_annual.png\")\nbarplot(tapply(year_total$x, year_total$Group.2, length), \n        xlab = \"Year\", \n        ylab = \"Number of Storms\", \n        main = \"Annual Frequency of Storms\")\ndev.off()   \npng(\"./images/trop_annual.png\")\nbarplot(tapply( group$x, group$Group.2, length), \n        xlab = \"Year\", \n        ylab = \"Number of Tropical Storms\", \n        main = \"Annual Frequency of Tropical Storms\")\ndev.off()\npng(\"./images/hurr_annual.png\")\nbarplot(tapply( group1$x, group1$Group.2, length), \n        xlab = \"Year\", \n        ylab = \"Number of Hurricanes\",\n        main = \"Annual Frquency of Hurricanes\")\ndev.off()\npng(\"./images/hurr3_annual.png\")\nbarplot(tapply( group2$x, group2$Group.2, length), \n        xlab = \"Year\", \n        ylab = \"Number of Stage 3 and Above Hurricanes\",\n        main = \"Annual Frequency of Stage 3 Hurricanes\")\ndev.off()\npng(\"./images/storms_monthly.png\")\nbarplot(tapply( month$x, month$Group.2, length), \n        xlab = \"Month\", \n        ylab = \"Number of Storms\",\n        main = \"Monthly Frequency of Storms\")\ndev.off()\npng(\"./images/trop_monthly.png\")\nbarplot(tapply( group3$x, group3$Group.2, length), \n        xlab = \"Month\", \n        ylab = \"Number of Tropical Storms\",\n        main = \"Monthly Frequency of Tropical Storms\")\ndev.off()\npng(\"./images/hurr_monthly.png\")\nbarplot(tapply( group4$x, group4$Group.2, length), \n        xlab = \"Month\", \n        ylab = \"Number of Hurricanes\",\n        main = \"Monthly Frequency of Hurricanes\")\ndev.off()\npng(\"./images/hurr3_monthly.png\")\nbarplot(tapply( group5$x, group5$Group.2, length), \n        xlab = \"Month\", \n        ylab = \"Number of Stage 3 and Above Hurricanes\",\n        main = \"Monthly Frequency of Stage 3 and Above Hurricanes\")\ndev.off()\n\n\n#Creating pdf files for each of the plots\npdf(\"./images/storms_annual.pdf\")\nbarplot(tapply(year_total$x, year_total$Group.2, length), \n        xlab = \"Year\", \n        ylab = \"Number of Storms\", \n        main = \"Annual Frequency of Storms\")\ndev.off()   \npdf(\"./images/trop_annual.pdf\")\nbarplot(tapply( group$x, group$Group.2, length), \n        xlab = \"Year\", \n        ylab = \"Number of Tropical Storms\", \n        main = \"Annual Frequency of Tropical Storms\")\ndev.off()\npdf(\"./images/hurr_annual.pdf\")\nbarplot(tapply( group1$x, group1$Group.2, length), \n        xlab = \"Year\", \n        ylab = \"Number of Hurricanes\",\n        main = \"Annual Frquency of Hurricanes\")\ndev.off()\npdf(\"./images/hurr3_annual.pdf\")\nbarplot(tapply( group2$x, group2$Group.2, length), \n        xlab = \"Year\", \n        ylab = \"Number of Stage 3 and Above Hurricanes\",\n        main = \"Annual Frequency of Stage 3 Hurricanes\")\ndev.off()\npdf(\"./images/storms_monthly.pdf\")\nbarplot(tapply( month$x, month$Group.2, length), \n        xlab = \"Month\", \n        ylab = \"Number of Storms\",\n        main = \"Monthly Frequency of Storms\")\ndev.off()\npdf(\"./images/trop_monthly.pdf\")\nbarplot(tapply( group3$x, group3$Group.2, length), \n        xlab = \"Month\", \n        ylab = \"Number of Tropical Storms\",\n        main = \"Monthly Frequency of Tropical Storms\")\ndev.off()\npdf(\"./images/hurr_monthly.pdf\")\nbarplot(tapply( group4$x, group4$Group.2, length), \n        xlab = \"Month\", \n        ylab = \"Number of Hurricanes\",\n        main = \"Monthly Frequency of Hurricanes\")\ndev.off()\npdf(\"./images/hurr3_monthly.pdf\")\nbarplot(tapply( group5$x, group5$Group.2, length), \n        xlab = \"Month\", \n        ylab = \"Number of Stage 3 and Above Hurricanes\",\n        main = \"Monthly Frequency of Stage 3 and Above Hurricanes\")\ndev.off()\n\n\n\n##Regression Analysis\n#mean pressure on mean wind\nmean_pressures = aggregate(modern[, \"tracks_pressure\"], list(modern$tracks_id), mean)\nmean_winds = aggregate(modern[, \"tracks_wind\"], list(modern$tracks_id), mean)\nmean_pressure_wind = merge(mean_pressures, mean_winds, by = \"Group.1\")\nmean_pressure_wind = filter(mean_pressure_wind, tracks_pressure > 0)\nmean_pressure_wind = mean_pressure_wind[, c(2, 3)]\n\nmean_pressure_wind_reg = lm(tracks_pressure ~ tracks_wind, data = mean_pressure_wind)\nmean_pressure_wind_plot = ggplot(mean_pressure_wind, aes(x = tracks_pressure, y = tracks_wind)) + \n  geom_point() + geom_smooth(method = \"lm\") + xlab(\"Pressure\") + ylab(\"Wind\") +\n  ggtitle(\"Mean Pressure vs Mean Wind\")\n\n#Outliers skew the regression line. Removing outliers:\nmean_pressure_wind_clean = filter(mean_pressure_wind, tracks_pressure > 950)\nmean_pressure_wind_clean_reg = lm(tracks_pressure ~ tracks_wind, data = mean_pressure_wind_clean)\nmean_pressure_wind_clean_plot = ggplot(mean_pressure_wind_clean, aes(x = tracks_pressure, y = tracks_wind)) + \n  geom_point() + geom_smooth(method = \"lm\") + xlab(\"Pressure\") + ylab(\"Wind\") +\n  ggtitle(\"Mean Pressure vs Mean Wind, outliers removed\")\n\n#median pressure on median wind\nmedian_pressures = aggregate(modern[, \"tracks_pressure\"], list(modern$tracks_id), median)\nmedian_winds = aggregate(modern[, \"tracks_wind\"], list(modern$tracks_id), median)\nmedian_pressure_wind = merge(median_pressures, median_winds, by = \"Group.1\")\nmedian_pressure_wind = filter(median_pressure_wind, tracks_pressure > 0)\nmedian_pressure_wind = median_pressure_wind[, c(2, 3)]\n\nmedian_pressure_wind_reg = lm(tracks_pressure ~ tracks_wind, data = median_pressure_wind)\nmedian_pressure_wind_plot = ggplot(median_pressure_wind, aes(x = tracks_pressure, y = tracks_wind)) + \n  geom_point() + geom_smooth(method = \"lm\") + xlab(\"Pressure\") + ylab(\"Wind\") +\n  ggtitle(\"Median Pressure vs Median Wind\")\n\n#png's and pdf's of regression plots:\npng(\"./images/mean_pressure_wind.png\")\nmean_pressure_wind_plot\ndev.off()\npng(\"./images/mean_pressure_wind_clean.png\")\nmean_pressure_wind_clean_plot\ndev.off()\npng(\"./images/median_pressure_wind.png\")\nmedian_pressure_wind_plot\ndev.off()\n\npdf(\"./images/mean_pressure_wind.pdf\")\nmean_pressure_wind_plot\ndev.off()\npdf(\"./images/mean_pressure_wind_clean.pdf\")\nmean_pressure_wind_clean_plot\ndev.off()\npdf(\"./images/median_pressure_wind.pdf\")\nmedian_pressure_wind_plot\ndev.off()\n\n",
    "created" : 1439597703216.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4260687881",
    "id" : "F34C9701",
    "lastKnownWriteTime" : 1439594747,
    "path" : "~/Desktop/Final_Project/code/analysis.R",
    "project_path" : "code/analysis.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}